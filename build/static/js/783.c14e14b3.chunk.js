"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[783],{68438:function(e,n,t){t.d(n,{Z:function(){return o}});var r=t(74165),a=t(15861),u=t(74569),i=t.n(u);i().defaults.baseURL="".concat("https://richparfum.uz/backend/api"),i().interceptors.request.use((function(e){var n=function(e){try{return localStorage.getItem(e)}catch(n){console.log("Error getting data")}}("richtoken"),t=null!==n?"Bearer ".concat(n):"";return e.headers.authorization=t,e}));var s=i(),o={getData:function(e){return(0,a.Z)((0,r.Z)().mark((function n(){var t,a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.get(e);case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}),n)})))()},getDataByID:function(e,n){return(0,a.Z)((0,r.Z)().mark((function t(){var a,u;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.get("".concat(e,"/").concat(n));case 2:return a=t.sent,u=a.data,t.abrupt("return",u);case 5:case"end":return t.stop()}}),t)})))()},postData:function(e,n){return(0,a.Z)((0,r.Z)().mark((function t(){var a,u;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.post(e,n);case 2:return a=t.sent,u=a.data,t.abrupt("return",u);case 5:case"end":return t.stop()}}),t)})))()},editData:function(e,n,t){return(0,a.Z)((0,r.Z)().mark((function a(){var u,i;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.put("".concat(e,"/").concat(t,"/"),n);case 2:return u=r.sent,i=u.data,r.abrupt("return",i);case 5:case"end":return r.stop()}}),a)})))()},deleteData:function(e,n){return(0,a.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.delete("".concat(e,"/").concat(n));case 2:case"end":return t.stop()}}),t)})))()},deleteImages:function(e,n){return(0,a.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.delete(e,{data:n});case 2:case"end":return t.stop()}}),t)})))()}}},98783:function(e,n,t){t.r(n);var r=t(74165),a=t(15861),u=t(29439),i=t(72791),s=t(2409),o=t(50419),c=t(66106),d=t(30914),l=t(49389),f=t(93086),m=t(87309),p=t(91933),v=t(68438),Z=t(14138),g=t(57689),h=t(16030),x=t(77221),w=t(22645),b=t(80184),j={name_uz:"",name_ru:"",image:""};n.default=function(){var e=s.Z.useForm(),n=(0,u.Z)(e,1)[0],t=(0,g.s0)(),F=(0,h.v9)((function(e){return e.editData})).editId,y=(0,h.I0)(),S=(0,i.useState)([]),k=(0,u.Z)(S,2),I=k[0],D=k[1],_=(0,p.useMutation)((function(e){var n=e.url,t=e.data;return v.Z.postData(n,t)}),{onSuccess:function(){o.ZP.success("Success")},onError:function(e){for(var n in e.response.data)o.ZP.error("".concat(n,": ").concat(e.response.data[n][0]))}}),E=_.mutate,L=_.data,z=_.isLoading,V=_.isSuccess,P=(0,p.useQuery)(["edit-brand",F],(function(){return v.Z.getDataByID("/products/brand",F)}),{enabled:!1}),C=P.isLoading,q=P.data,O=P.refetch,U=P.isSuccess,B=(0,p.useMutation)((function(e){var n=e.url,t=e.data,r=e.id;return v.Z.editData(n,t,r)}),{onSuccess:function(){o.ZP.success("Success")},onError:function(e){for(var n in e.response.data)o.ZP.error("".concat(n,": ").concat(e.response.data[n][0]))}}),R=B.mutate,T=B.isLoading,M=B.data,N=B.isSuccess;(0,i.useEffect)((function(){N&&y({type:x.Pb,payload:""}),(V||N)&&t("/brand")}),[L,M]),(0,i.useEffect)((function(){""!==F&&O()}),[F]),(0,i.useEffect)((function(){""===F&&n.setFieldsValue(j)}),[]),(0,i.useEffect)((function(){if(U){var e=[{uid:null===q||void 0===q?void 0:q.id,name:null===q||void 0===q?void 0:q.id,status:"done",url:null===q||void 0===q?void 0:q.image}],t={name_uz:q.name_uz,name_ru:q.name_ru,image:q.image};D(e),n.setFieldsValue(t)}}),[q]);(0,i.useEffect)((function(){var e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],n.setFieldsValue(e));var t=function(){localStorage.setItem("myFormValues",JSON.stringify(n.getFieldsValue()))};return window.addEventListener("beforeunload",t),function(){localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);var A=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t,a,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.url){e.next=5;break}return e.next=4,new Promise((function(e){var t=new FileReader;t.readAsDataURL(n.originFileObj),t.onload=function(){return e(t.result)}}));case 4:t=e.sent;case 5:(a=new Image).src=t,null===(u=window.open(t))||void 0===u||u.document.write(a.outerHTML);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,b.jsx)("div",{children:z||C||T?(0,b.jsx)(Z.QP,{}):(0,b.jsxs)(s.Z,{form:n,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:j,onFinish:function(e){var n,t,r=new FormData;(r.append("name_uz",e.name_uz),r.append("name_ru",e.name_ru),null!==(n=I[0])&&void 0!==n&&n.originFileObj)&&r.append("image",null===(t=I[0])||void 0===t?void 0:t.originFileObj);q?R({url:"/products/brand",data:r,id:F}):E({url:"/products/brand/",data:r})},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,b.jsxs)(c.Z,{gutter:20,children:[(0,b.jsx)(d.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:"Name Uz",name:"name_uz",rules:[{required:!0,message:"Brand nomi kiritish talab qilinadi"}],children:(0,b.jsx)(l.Z,{})})}),(0,b.jsx)(d.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:"\u0418\u043c\u044f Ru",name:"name_ru",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0418\u043c\u044f \u0431\u0440\u0435\u043d\u0434\u0430"}],children:(0,b.jsx)(l.Z,{})})})]}),(0,b.jsx)(c.Z,{gutter:20,children:(0,b.jsx)(s.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0440\u0435\u043d\u0434\u0430",name:"image",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0440\u0435\u043d\u0434\u0430"}],children:(0,b.jsx)(w.Z,{rotationSlider:!0,children:(0,b.jsx)(f.Z,{maxCount:1,fileList:I,listType:"picture-card",onChange:function(e){var t=e.fileList;D(t),n.setFieldsValue({image:t})},onPreview:A,beforeUpload:function(){return!1},children:I.length>0?"":"Upload"})})})}),(0,b.jsx)(m.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:U?"Edit":"Add"})]})})}},30914:function(e,n,t){var r=t(89752);n.Z=r.Z}}]);
//# sourceMappingURL=783.c14e14b3.chunk.js.map