"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[16],{68438:function(e,n,t){t.d(n,{Z:function(){return s}});var r=t(74165),a=t(15861),i=t(74569),u=t.n(i);u().defaults.baseURL="".concat("https://richparfum.uz/backend/api"),u().interceptors.request.use((function(e){var n=function(e){try{return localStorage.getItem(e)}catch(n){console.log("Error getting data")}}("richtoken"),t=null!==n?"Bearer ".concat(n):"";return e.headers.authorization=t,e}));var o=u(),s={getData:function(e){return(0,a.Z)((0,r.Z)().mark((function n(){var t,a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.get(e);case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}),n)})))()},getDataByID:function(e,n){return(0,a.Z)((0,r.Z)().mark((function t(){var a,i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.get("".concat(e,"/").concat(n));case 2:return a=t.sent,i=a.data,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})))()},postData:function(e,n){return(0,a.Z)((0,r.Z)().mark((function t(){var a,i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.post(e,n);case 2:return a=t.sent,i=a.data,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})))()},editData:function(e,n,t){return(0,a.Z)((0,r.Z)().mark((function a(){var i,u;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.put("".concat(e,"/").concat(t,"/"),n);case 2:return i=r.sent,u=i.data,r.abrupt("return",u);case 5:case"end":return r.stop()}}),a)})))()},deleteData:function(e,n){return(0,a.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.delete("".concat(e,"/").concat(n));case 2:case"end":return t.stop()}}),t)})))()},deleteImages:function(e,n){return(0,a.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.delete(e,{data:n});case 2:case"end":return t.stop()}}),t)})))()}}},50016:function(e,n,t){t.r(n);var r=t(74165),a=t(15861),i=t(29439),u=t(72791),o=t(2409),s=t(50419),c=t(66106),l=t(30914),d=t(83734),f=t(93086),p=t(87309),m=t(91933),v=t(68438),g=t(14138),Z=t(57689),b=t(16030),h=t(77221),x=t(22645),w=t(80184),j={image_uz:"",image_ru:"",season:"",brand:""};n.default=function(){var e=o.Z.useForm(),n=(0,i.Z)(e,1)[0],t=(0,Z.s0)(),y=(0,b.v9)((function(e){return e.editData})).editId,F=(0,b.I0)(),S=(0,u.useState)([]),I=(0,i.Z)(S,2),_=I[0],D=I[1],k=(0,u.useState)([]),L=(0,i.Z)(k,2),z=L[0],C=L[1],E=(0,m.useMutation)((function(e){var n=e.url,t=e.data;return v.Z.postData(n,t)}),{onSuccess:function(){s.ZP.success("Success")},onError:function(e){for(var n in e.response.data)s.ZP.error("".concat(n,": ").concat(e.response.data[n][0]))}}),P=E.mutate,V=E.data,U=E.isLoading,O=E.isSuccess,M=(0,m.useQuery)("get-brand",(function(){return v.Z.getData("/products/brand/")}),{enabled:!1}),R=M.data,T=M.refetch,q=(0,m.useQuery)(["edit-first-banner",y],(function(){return v.Z.getDataByID("/about/header-banner-first",y)}),{enabled:!1}),B=q.isLoading,Q=q.data,A=q.refetch,J=q.isSuccess,N=(0,m.useMutation)((function(e){var n=e.url,t=e.data,r=e.id;return v.Z.editData(n,t,r)}),{onSuccess:function(){s.ZP.success("Success")},onError:function(e){for(var n in e.response.data)s.ZP.error("".concat(n,": ").concat(e.response.data[n][0]))}}),H=N.mutate,W=N.isLoading,G=N.data,K=N.isSuccess;(0,u.useEffect)((function(){K&&F({type:h.Pb,payload:""}),(O||K)&&t("/banner-first")}),[V,G]),(0,u.useEffect)((function(){""!==y&&A()}),[y]),(0,u.useEffect)((function(){""===y&&n.setFieldsValue(j),T()}),[]),(0,u.useEffect)((function(){if(J){var e=[{uid:null===Q||void 0===Q?void 0:Q.id,name:null===Q||void 0===Q?void 0:Q.id,status:"done",url:null===Q||void 0===Q?void 0:Q.image_uz}],t=[{uid:null===Q||void 0===Q?void 0:Q.id,name:null===Q||void 0===Q?void 0:Q.id,status:"done",url:null===Q||void 0===Q?void 0:Q.image_ru}],r={brand:Q.brand,season:Q.season,image_uz:Q.image_uz,image_ru:Q.image_ru};D(e),C(t),n.setFieldsValue(r)}}),[Q]);(0,u.useEffect)((function(){var e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],n.setFieldsValue(e));var t=function(){localStorage.setItem("myFormValues",JSON.stringify(n.getFieldsValue()))};return window.addEventListener("beforeunload",t),function(){localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);var X=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t,a,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.url){e.next=5;break}return e.next=4,new Promise((function(e){var t=new FileReader;t.readAsDataURL(n.originFileObj),t.onload=function(){return e(t.result)}}));case 4:t=e.sent;case 5:(a=new Image).src=t,null===(i=window.open(t))||void 0===i||i.document.write(a.outerHTML);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Y=(0,u.useMemo)((function(){return[{value:"spring",label:"\u0412\u0435\u0441\u043d\u0430"},{value:"summer",label:"\u041b\u0435\u0442\u043e"},{value:"autumn",label:"\u041e\u0441\u0435\u043d\u044c"},{value:"winter",label:"\u0417\u0438\u043c\u0430"}]}),[]),$=(0,u.useMemo)((function(){return null===R||void 0===R?void 0:R.map((function(e){return{value:null===e||void 0===e?void 0:e.name_ru,label:null===e||void 0===e?void 0:e.name_ru}}))}),[R]);return(0,w.jsx)("div",{children:U||B||W?(0,w.jsx)(g.QP,{}):(0,w.jsxs)(o.Z,{form:n,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:j,onFinish:function(e){var n,t,r,a,i=new FormData;(i.append("season",e.season),i.append("brand",e.brand),null!==(n=_[0])&&void 0!==n&&n.originFileObj)&&i.append("image_uz",null===(r=_[0])||void 0===r?void 0:r.originFileObj);null!==(t=z[0])&&void 0!==t&&t.originFileObj&&i.append("image_ru",null===(a=z[0])||void 0===a?void 0:a.originFileObj);Q?H({url:"/about/header-banner-first",data:i,id:y}):P({url:"/about/header-banner-first/",data:i})},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,w.jsxs)(c.Z,{gutter:20,children:[(0,w.jsx)(l.Z,{span:12,children:(0,w.jsx)(o.Z.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u0432\u043e\u0434",name:"season",wrapperCol:{span:24},children:(0,w.jsx)(d.Z,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u043f\u043e\u0432\u043e\u0434",optionLabelProp:"label",options:Y})})}),(0,w.jsx)(l.Z,{span:12,children:(0,w.jsx)(o.Z.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0440\u0435\u043d\u0434",name:"brand",wrapperCol:{span:24},children:(0,w.jsx)(d.Z,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u0431\u0440\u0435\u043d\u0434",optionLabelProp:"label",options:$})})})]}),(0,w.jsxs)(c.Z,{gutter:20,children:[(0,w.jsx)(l.Z,{span:12,children:(0,w.jsx)(o.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 Ru",name:"image_uz",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f Ru"}],children:(0,w.jsx)(x.Z,{rotationSlider:!0,children:(0,w.jsx)(f.Z,{maxCount:1,fileList:_,listType:"picture-card",onChange:function(e){var t=e.fileList;D(t),n.setFieldsValue({image_uz:t})},onPreview:X,beforeUpload:function(){return!1},children:_.length>0?"":"Upload"})})})}),(0,w.jsx)(l.Z,{span:12,children:(0,w.jsx)(o.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 Uz",name:"image_ru",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f Uz"}],children:(0,w.jsx)(x.Z,{rotationSlider:!0,children:(0,w.jsx)(f.Z,{maxCount:1,fileList:z,listType:"picture-card",onChange:function(e){var t=e.fileList;C(t),n.setFieldsValue({image_ru:t})},onPreview:X,beforeUpload:function(){return!1},children:z.length>0?"":"Upload"})})})})]}),(0,w.jsx)(p.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:J?"Edit":"Add"})]})})}},30914:function(e,n,t){var r=t(89752);n.Z=r.Z}}]);
//# sourceMappingURL=16.4161947c.chunk.js.map