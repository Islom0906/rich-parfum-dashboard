"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[783],{98783:(e,a,s)=>{s.r(a),s.d(a,{default:()=>j});var t=s(72791),n=s(2409),r=s(50419),i=s(66106),l=s(30914),o=s(49389),d=s(93086),u=s(87309),c=s(91933),m=s(27169),p=s(14138),g=s(57689),f=s(16030),h=s(77221),b=s(68117),v=s(80184);const Z={name_uz:"",name_ru:"",image:""},j=()=>{const[e]=n.Z.useForm(),a=(0,g.s0)(),{editId:s}=(0,f.v9)((e=>e.editData)),j=(0,f.I0)(),[x,F]=(0,t.useState)([]),{mutate:w,data:y,isLoading:S,isSuccess:I}=(0,c.useMutation)((e=>{let{url:a,data:s}=e;return m.Z.postData(a,s)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{for(let a in e.response.data)r.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}}),{isLoading:_,data:E,refetch:L,isSuccess:V}=(0,c.useQuery)(["edit-brand",s],(()=>m.Z.getDataByID("/products/brand",s)),{enabled:!1}),{mutate:D,isLoading:P,data:z,isSuccess:C}=(0,c.useMutation)((e=>{let{url:a,data:s,id:t}=e;return m.Z.editData(a,s,t)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{for(let a in e.response.data)r.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}});(0,t.useEffect)((()=>{C&&j({type:h.Pb,payload:""}),(I||C)&&a("/brand")}),[y,z]),(0,t.useEffect)((()=>{""!==s&&L()}),[s]),(0,t.useEffect)((()=>{""===s&&e.setFieldsValue(Z)}),[]),(0,t.useEffect)((()=>{if(V){const a=[{uid:null===E||void 0===E?void 0:E.id,name:null===E||void 0===E?void 0:E.id,status:"done",url:null===E||void 0===E?void 0:E.image}],s={name_uz:E.name_uz,name_ru:E.name_ru,image:E.image};F(a),e.setFieldsValue(s)}}),[E]);(0,t.useEffect)((()=>{const a=JSON.parse(localStorage.getItem("myFormValues"));a&&(a.images=[],e.setFieldsValue(a));const s=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",s),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",s)}}),[]);return(0,v.jsx)("div",{children:S||_||P?(0,v.jsx)(p.QP,{}):(0,v.jsxs)(n.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:Z,onFinish:e=>{var a;const t=new FormData;var n;(t.append("name_uz",e.name_uz),t.append("name_ru",e.name_ru),null!==(a=x[0])&&void 0!==a&&a.originFileObj)&&t.append("image",null===(n=x[0])||void 0===n?void 0:n.originFileObj);E?D({url:"/products/brand",data:t,id:s}):w({url:"/products/brand/",data:t})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,v.jsxs)(i.Z,{gutter:20,children:[(0,v.jsx)(l.Z,{span:12,children:(0,v.jsx)(n.Z.Item,{label:"Name Uz",name:"name_uz",rules:[{required:!0,message:"Brand nomi kiritish talab qilinadi"}],children:(0,v.jsx)(o.default,{})})}),(0,v.jsx)(l.Z,{span:12,children:(0,v.jsx)(n.Z.Item,{label:"\u0418\u043c\u044f Ru",name:"name_ru",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0418\u043c\u044f \u0431\u0440\u0435\u043d\u0434\u0430"}],children:(0,v.jsx)(o.default,{})})})]}),(0,v.jsx)(i.Z,{gutter:20,children:(0,v.jsx)(n.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0440\u0435\u043d\u0434\u0430",name:"image",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0440\u0435\u043d\u0434\u0430"}],children:(0,v.jsx)(b.Z,{rotationSlider:!0,children:(0,v.jsx)(d.Z,{maxCount:1,fileList:x,listType:"picture-card",onChange:a=>{let{fileList:s}=a;F(s),e.setFieldsValue({image:s})},onPreview:async e=>{let a=e.url;a||(a=await new Promise((a=>{const s=new FileReader;s.readAsDataURL(e.originFileObj),s.onload=()=>a(s.result)})));const s=new Image;s.src=a;const t=window.open(a);null===t||void 0===t||t.document.write(s.outerHTML)},beforeUpload:()=>!1,children:x.length>0?"":"Upload"})})})}),(0,v.jsx)(u.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:V?"Edit":"Add"})]})})}},30914:(e,a,s)=>{s.d(a,{Z:()=>t});const t=s(89752).Z}}]);
//# sourceMappingURL=783.b594c885.chunk.js.map