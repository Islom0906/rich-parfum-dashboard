"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[967],{44967:(e,o,t)=>{t.r(o),t.d(o,{default:()=>F});var s=t(72791),a=t(2409),l=t(50419),i=t(66106),r=t(93086),n=t(87309),d=t(91933),u=t(27169),c=t(14138),m=t(57689),g=t(16030),p=t(77221),f=t(68117),v=t(80184);const h={logo:""},F=()=>{const[e]=a.Z.useForm(),o=(0,m.s0)(),{editId:t}=(0,g.v9)((e=>e.editData)),F=(0,g.I0)(),[w,y]=(0,s.useState)([]),{mutate:S,data:b,isLoading:Z,isSuccess:x}=(0,d.useMutation)((e=>{let{url:o,data:t}=e;return u.Z.postData(o,t)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let o in e.response.data)l.ZP.error("".concat(o,": ").concat(e.response.data[o][0]))}}),{isLoading:j,data:E,refetch:I,isSuccess:L}=(0,d.useQuery)(["edit-logo",t],(()=>u.Z.getDataByID("/products/site-logo",t)),{enabled:!1}),{mutate:V,isLoading:D,data:P,isSuccess:C}=(0,d.useMutation)((e=>{let{url:o,data:t,id:s}=e;return u.Z.editData(o,t,s)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let o in e.response.data)l.ZP.error("".concat(o,": ").concat(e.response.data[o][0]))}});(0,s.useEffect)((()=>{C&&F({type:p.Pb,payload:""}),(x||C)&&o("/logo")}),[b,P]),(0,s.useEffect)((()=>{""!==t&&I()}),[t]),(0,s.useEffect)((()=>{""===t&&e.setFieldsValue(h)}),[]),(0,s.useEffect)((()=>{if(L){const o=[{uid:null===E||void 0===E?void 0:E.id,name:null===E||void 0===E?void 0:E.id,status:"done",url:null===E||void 0===E?void 0:E.logo}],t={logo:E.logo};y(o),e.setFieldsValue(t)}}),[E]);(0,s.useEffect)((()=>{const o=JSON.parse(localStorage.getItem("myFormValues"));o&&(o.images=[],e.setFieldsValue(o));const t=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",t),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);return(0,v.jsx)("div",{children:Z||j||D?(0,v.jsx)(c.QP,{}):(0,v.jsxs)(a.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:h,onFinish:()=>{var e;const o=new FormData;var s;null!==(e=w[0])&&void 0!==e&&e.originFileObj&&o.append("logo",null===(s=w[0])||void 0===s?void 0:s.originFileObj);E?V({url:"/products/site-logo",data:o,id:t}):S({url:"/products/site-logo/",data:o})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,v.jsx)(i.Z,{gutter:20,children:(0,v.jsx)(a.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u043e\u0442\u0438\u043f \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 png 90x60",name:"logo",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u043e\u0442\u0438\u043f"}],children:(0,v.jsx)(f.Z,{rotationSlider:!0,children:(0,v.jsx)(r.Z,{maxCount:1,fileList:w,listType:"picture-card",onChange:o=>{let{fileList:t}=o;y(t),e.setFieldsValue({logo:t})},onPreview:async e=>{let o=e.url;o||(o=await new Promise((o=>{const t=new FileReader;t.readAsDataURL(e.originFileObj),t.onload=()=>o(t.result)})));const t=new Image;t.src=o;const s=window.open(o);null===s||void 0===s||s.document.write(t.outerHTML)},beforeUpload:()=>!1,children:w.length>0?"":"Upload"})})})}),(0,v.jsx)(n.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:L?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=967.cfab512c.chunk.js.map