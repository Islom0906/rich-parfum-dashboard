"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[325],{325:(e,a,t)=>{t.r(a),t.d(a,{default:()=>b});var s=t(72791),l=t(2409),r=t(50419),n=t(66106),i=t(30914),u=t(49389),o=t(87309),d=t(91933),m=t(27169),c=t(14138),g=t(57689),p=t(16030),h=t(77221),f=t(7993),x=t(80184);const j={name_ru:"",name_uz:"",workingTime:"",tel:"",lat:""},b=()=>{const{isLoaded:e}=(0,f.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyDt2upRTGqJ3BOGeKN1aCG5dByeOspcREk",libraries:["geometry","drawing"]}),[a]=l.Z.useForm(),t=(0,g.s0)(),{editId:b}=(0,p.v9)((e=>e.editData)),Z=(0,p.I0)(),[y,S]=(0,s.useState)({lat:null,lng:null}),[F,I]=(0,s.useState)({lat:41.311785,lng:69.279696}),{mutate:w,data:E,isLoading:v,isSuccess:C}=(0,d.useMutation)((e=>{let{url:a,data:t}=e;return m.Z.postData(a,t)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{r.ZP.error(e)}}),{isLoading:V,data:k,refetch:z,isSuccess:L}=(0,d.useQuery)(["edit-map",b],(()=>m.Z.getDataByID("/about/map",b)),{enabled:!1}),{mutate:_,isLoading:D,data:P,isSuccess:q}=(0,d.useMutation)((e=>{let{url:a,data:t,id:s}=e;return m.Z.editData(a,t,s)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{r.ZP.error(e.message)}});(0,s.useEffect)((()=>{q&&Z({type:h.Pb,payload:""}),(C||q)&&t("/map")}),[E,P]),(0,s.useEffect)((()=>{""!==b&&z()}),[b]),(0,s.useEffect)((()=>{""===b&&a.setFieldsValue(j)}),[]),(0,s.useEffect)((()=>{if(L){const e={name_ru:k.name_ru,name_uz:k.name_uz,phone:k.phone,lat:k.lat};S({lat:Number(k.lat),lng:Number(k.lng)}),a.setFieldsValue(e)}}),[k]);(0,s.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],a.setFieldsValue(e));const t=()=>{localStorage.setItem("myFormValues",JSON.stringify(a.getFieldsValue()))};return window.addEventListener("beforeunload",t),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);return(0,x.jsx)("div",{children:v||V||D?(0,x.jsx)(c.QP,{}):(0,x.jsxs)(l.Z,{form:a,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:j,onFinish:e=>{const a={...e,lat:y.lat,lng:y.lng};k?_({url:"/about/map",data:a,id:b}):w({url:"/about/map/",data:a})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,x.jsxs)(n.Z,{gutter:20,children:[(0,x.jsx)(i.Z,{span:12,children:(0,x.jsx)(l.Z.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u043b\u0438\u0430\u043b\u0430 Ru",name:"name_ru",rules:[{required:!0,message:"\u0412\u0432\u043e\u0434 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0444\u0438\u043b\u0438\u0430\u043b\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d Ru!"}],children:(0,x.jsx)(u.default,{})})}),(0,x.jsx)(i.Z,{span:12,children:(0,x.jsx)(l.Z.Item,{label:"Filial nomi Uz",name:"name_uz",rules:[{required:!0,message:"Filial nomini kiritish majburiy Uz!"}],children:(0,x.jsx)(u.default,{})})})]}),(0,x.jsx)(n.Z,{gutter:20,children:(0,x.jsx)(i.Z,{span:24,children:(0,x.jsx)(l.Z.Item,{label:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",name:"phone",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430!"}],children:(0,x.jsx)(u.default,{})})})}),(0,x.jsx)(n.Z,{gutter:20,children:(0,x.jsxs)(i.Z,{span:24,children:[e&&(0,x.jsx)(f.b6,{mapContainerStyle:{height:"400px",width:"100%"},zoom:12,center:F,onClick:e=>{const t={lat:e.latLng.lat(),lng:null===e||void 0===e?void 0:e.latLng.lng()};I(t),S(t),a.setFieldsValue({lat:t.lat})},children:(0,x.jsx)(f.jC,{position:y})}),(0,x.jsx)(l.Z.Item,{label:"",name:"lat",rules:[{required:!0,message:"\u0420\u0430\u0437\u043c\u0435\u0442\u043a\u0430 \u043a\u0430\u0440\u0442\u044b \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430"}]})]})}),(0,x.jsx)(o.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:L?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=325.3d12e6ca.chunk.js.map