"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[846],{69846:(e,a,l)=>{l.r(a),l.d(a,{default:()=>j});var s=l(72791),i=l(2409),n=l(50419),t=l(66106),o=l(30914),r=l(83734),d=l(93086),u=l(87309),c=l(91933),m=l(27169),p=l(14138),g=l(57689),v=l(16030),h=l(77221),b=l(68117),f=l(80184);const Z={image_uz:"",image_ru:"",discount:"",smell:""},j=()=>{const[e]=i.Z.useForm(),a=(0,g.s0)(),{editId:l}=(0,v.v9)((e=>e.editData)),j=(0,v.I0)(),[x,w]=(0,s.useState)([]),[F,y]=(0,s.useState)([]),{mutate:S,data:_,isLoading:I,isSuccess:L}=(0,c.useMutation)((e=>{let{url:a,data:l}=e;return m.Z.postData(a,l)}),{onSuccess:()=>{n.ZP.success("Success")},onError:e=>{for(let a in e.response.data)n.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}}),{data:C,refetch:P}=(0,c.useQuery)("get-brand",(()=>m.Z.getData("/products/smell/")),{enabled:!1}),{isLoading:E,data:V,refetch:D,isSuccess:z}=(0,c.useQuery)(["edit-second-banner",l],(()=>m.Z.getDataByID("/about/header-banner-second",l)),{enabled:!1}),{mutate:O,isLoading:U,data:M,isSuccess:R}=(0,c.useMutation)((e=>{let{url:a,data:l,id:s}=e;return m.Z.editData(a,l,s)}),{onSuccess:()=>{n.ZP.success("Success")},onError:e=>{for(let a in e.response.data)n.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}});(0,s.useEffect)((()=>{R&&j({type:h.Pb,payload:""}),(L||R)&&a("/banner-second")}),[_,M]),(0,s.useEffect)((()=>{""!==l&&D()}),[l]),(0,s.useEffect)((()=>{""===l&&e.setFieldsValue(Z),P()}),[]),(0,s.useEffect)((()=>{if(z){const a=[{uid:null===V||void 0===V?void 0:V.id,name:null===V||void 0===V?void 0:V.id,status:"done",url:null===V||void 0===V?void 0:V.image_uz}],l=[{uid:null===V||void 0===V?void 0:V.id,name:null===V||void 0===V?void 0:V.id,status:"done",url:null===V||void 0===V?void 0:V.image_ru}],s={discount:V.discount,smell:V.smell,image_uz:V.image_uz,image_ru:V.image_ru};w(a),y(l),e.setFieldsValue(s)}}),[V]);(0,s.useEffect)((()=>{const a=JSON.parse(localStorage.getItem("myFormValues"));a&&(a.images=[],e.setFieldsValue(a));const l=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",l),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",l)}}),[]);const T=async e=>{let a=e.url;a||(a=await new Promise((a=>{const l=new FileReader;l.readAsDataURL(e.originFileObj),l.onload=()=>a(l.result)})));const l=new Image;l.src=a;const s=window.open(a);null===s||void 0===s||s.document.write(l.outerHTML)},k=(0,s.useMemo)((()=>[{value:"\u0412\u0441\u0435",label:"\u0412\u0441\u0435"}]),[]),q=(0,s.useMemo)((()=>null===C||void 0===C?void 0:C.map((e=>({value:null===e||void 0===e?void 0:e.name_ru,label:null===e||void 0===e?void 0:e.name_ru})))),[C]);return(0,f.jsx)("div",{children:I||E||U?(0,f.jsx)(p.QP,{}):(0,f.jsxs)(i.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:Z,onFinish:e=>{var a,s;const i=new FormData;var n,t;(i.append("discount",e.discount),i.append("smell",e.smell),null!==(a=x[0])&&void 0!==a&&a.originFileObj)&&i.append("image_uz",null===(n=x[0])||void 0===n?void 0:n.originFileObj);null!==(s=F[0])&&void 0!==s&&s.originFileObj&&i.append("image_ru",null===(t=F[0])||void 0===t?void 0:t.originFileObj);V?O({url:"/about/header-banner-second",data:i,id:l}):S({url:"/about/header-banner-second/",data:i})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,f.jsxs)(t.Z,{gutter:20,children:[(0,f.jsx)(o.Z,{span:12,children:(0,f.jsx)(i.Z.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0421\u043a\u0438\u0434\u043a\u0430",name:"discount",wrapperCol:{span:24},children:(0,f.jsx)(r.default,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u0421\u043a\u0438\u0434\u043a\u0430",optionLabelProp:"label",options:k})})}),(0,f.jsx)(o.Z,{span:12,children:(0,f.jsx)(i.Z.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0417\u0430\u043f\u0430\u0445",name:"smell",wrapperCol:{span:24},children:(0,f.jsx)(r.default,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u0417\u0430\u043f\u0430\u0445",optionLabelProp:"label",options:q})})})]}),(0,f.jsxs)(t.Z,{gutter:20,children:[(0,f.jsx)(o.Z,{span:12,children:(0,f.jsx)(i.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 Ru",name:"image_ru",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f Ru"}],children:(0,f.jsx)(b.Z,{rotationSlider:!0,children:(0,f.jsx)(d.Z,{maxCount:1,fileList:F,listType:"picture-card",onChange:a=>{let{fileList:l}=a;y(l),e.setFieldsValue({image_ru:l})},onPreview:T,beforeUpload:()=>!1,children:F.length>0?"":"Upload"})})})}),(0,f.jsx)(o.Z,{span:12,children:(0,f.jsx)(i.Z.Item,{label:"Banner rasm Uz",name:"image_uz",rules:[{required:!0,message:"Banner Rasm talab qilinadi"}],children:(0,f.jsx)(b.Z,{rotationSlider:!0,children:(0,f.jsx)(d.Z,{maxCount:1,fileList:x,listType:"picture-card",onChange:a=>{let{fileList:l}=a;w(l),e.setFieldsValue({image_uz:l})},onPreview:T,beforeUpload:()=>!1,children:x.length>0?"":"Upload"})})})})]}),(0,f.jsx)(u.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:z?"Edit":"Add"})]})})}},30914:(e,a,l)=>{l.d(a,{Z:()=>s});const s=l(89752).Z}}]);
//# sourceMappingURL=846.cbb13f65.chunk.js.map