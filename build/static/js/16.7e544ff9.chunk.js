"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[16],{50016:(e,a,s)=>{s.r(a),s.d(a,{default:()=>j});var i=s(72791),n=s(2409),l=s(50419),t=s(66106),r=s(30914),o=s(83734),d=s(93086),u=s(87309),c=s(91933),m=s(27169),p=s(14138),b=s(57689),g=s(16030),v=s(77221),h=s(68117),f=s(80184);const Z={image_uz:"",image_ru:"",season:"",brand:""},j=()=>{const[e]=n.Z.useForm(),a=(0,b.s0)(),{editId:s}=(0,g.v9)((e=>e.editData)),j=(0,g.I0)(),[x,w]=(0,i.useState)([]),[F,y]=(0,i.useState)([]),{mutate:S,data:_,isLoading:I,isSuccess:L}=(0,c.useMutation)((e=>{let{url:a,data:s}=e;return m.Z.postData(a,s)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let a in e.response.data)l.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}}),{data:C,refetch:P}=(0,c.useQuery)("get-brand",(()=>m.Z.getData("/products/brand/")),{enabled:!1}),{isLoading:E,data:V,refetch:D,isSuccess:z}=(0,c.useQuery)(["edit-first-banner",s],(()=>m.Z.getDataByID("/about/header-banner-first",s)),{enabled:!1}),{mutate:O,isLoading:U,data:M,isSuccess:R}=(0,c.useMutation)((e=>{let{url:a,data:s,id:i}=e;return m.Z.editData(a,s,i)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let a in e.response.data)l.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}});(0,i.useEffect)((()=>{R&&j({type:v.Pb,payload:""}),(L||R)&&a("/banner-first")}),[_,M]),(0,i.useEffect)((()=>{""!==s&&D()}),[s]),(0,i.useEffect)((()=>{""===s&&e.setFieldsValue(Z),P()}),[]),(0,i.useEffect)((()=>{if(z){const a=[{uid:null===V||void 0===V?void 0:V.id,name:null===V||void 0===V?void 0:V.id,status:"done",url:null===V||void 0===V?void 0:V.image_uz}],s=[{uid:null===V||void 0===V?void 0:V.id,name:null===V||void 0===V?void 0:V.id,status:"done",url:null===V||void 0===V?void 0:V.image_ru}],i={brand:V.brand,season:V.season,image_uz:V.image_uz,image_ru:V.image_ru};w(a),y(s),e.setFieldsValue(i)}}),[V]);(0,i.useEffect)((()=>{const a=JSON.parse(localStorage.getItem("myFormValues"));a&&(a.images=[],e.setFieldsValue(a));const s=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",s),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",s)}}),[]);const T=async e=>{let a=e.url;a||(a=await new Promise((a=>{const s=new FileReader;s.readAsDataURL(e.originFileObj),s.onload=()=>a(s.result)})));const s=new Image;s.src=a;const i=window.open(a);null===i||void 0===i||i.document.write(s.outerHTML)},k=(0,i.useMemo)((()=>[{value:"spring",label:"\u0412\u0435\u0441\u043d\u0430"},{value:"summer",label:"\u041b\u0435\u0442\u043e"},{value:"autumn",label:"\u041e\u0441\u0435\u043d\u044c"},{value:"winter",label:"\u0417\u0438\u043c\u0430"}]),[]),q=(0,i.useMemo)((()=>null===C||void 0===C?void 0:C.map((e=>({value:null===e||void 0===e?void 0:e.name_ru,label:null===e||void 0===e?void 0:e.name_ru})))),[C]);return(0,f.jsx)("div",{children:I||E||U?(0,f.jsx)(p.QP,{}):(0,f.jsxs)(n.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:Z,onFinish:e=>{var a,i;const n=new FormData;var l,t;(n.append("season",e.season),n.append("brand",e.brand),null!==(a=x[0])&&void 0!==a&&a.originFileObj)&&n.append("image_uz",null===(l=x[0])||void 0===l?void 0:l.originFileObj);null!==(i=F[0])&&void 0!==i&&i.originFileObj&&n.append("image_ru",null===(t=F[0])||void 0===t?void 0:t.originFileObj);V?O({url:"/about/header-banner-first",data:n,id:s}):S({url:"/about/header-banner-first/",data:n})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,f.jsxs)(t.Z,{gutter:20,children:[(0,f.jsx)(r.Z,{span:12,children:(0,f.jsx)(n.Z.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u0432\u043e\u0434",name:"season",wrapperCol:{span:24},children:(0,f.jsx)(o.default,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u043f\u043e\u0432\u043e\u0434",optionLabelProp:"label",options:k})})}),(0,f.jsx)(r.Z,{span:12,children:(0,f.jsx)(n.Z.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0440\u0435\u043d\u0434",name:"brand",wrapperCol:{span:24},children:(0,f.jsx)(o.default,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u0431\u0440\u0435\u043d\u0434",optionLabelProp:"label",options:q})})})]}),(0,f.jsxs)(t.Z,{gutter:20,children:[(0,f.jsx)(r.Z,{span:12,children:(0,f.jsx)(n.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 Ru",name:"image_ru",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f Ru"}],children:(0,f.jsx)(h.Z,{rotationSlider:!0,children:(0,f.jsx)(d.Z,{maxCount:1,fileList:F,listType:"picture-card",onChange:a=>{let{fileList:s}=a;y(s),e.setFieldsValue({image_ru:s})},onPreview:T,beforeUpload:()=>!1,children:F.length>0?"":"Upload"})})})}),(0,f.jsx)(r.Z,{span:12,children:(0,f.jsx)(n.Z.Item,{label:"Banner rasm  Uz",name:"image_uz",rules:[{required:!0,message:"Banner Rasm talab qilinadi"}],children:(0,f.jsx)(h.Z,{rotationSlider:!0,children:(0,f.jsx)(d.Z,{maxCount:1,fileList:x,listType:"picture-card",onChange:a=>{let{fileList:s}=a;w(s),e.setFieldsValue({image_uz:s})},onPreview:T,beforeUpload:()=>!1,children:x.length>0?"":"Upload"})})})})]}),(0,f.jsx)(u.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:z?"Edit":"Add"})]})})}},30914:(e,a,s)=>{s.d(a,{Z:()=>i});const i=s(89752).Z}}]);
//# sourceMappingURL=16.7e544ff9.chunk.js.map