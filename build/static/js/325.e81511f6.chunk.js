"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[325],{325:(e,a,s)=>{s.r(a),s.d(a,{default:()=>b});var t=s(72791),l=s(2409),r=s(50419),n=s(66106),i=s(30914),u=s(49389),o=s(87309),d=s(91933),m=s(27169),c=s(14138),g=s(57689),p=s(16030),h=s(77221),f=s(7993),x=s(80184);const j={name_ru:"",name_uz:"",workingTime:"",tel:"",lat:""},b=()=>{const{isLoaded:e}=(0,f.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyDt2upRTGqJ3BOGeKN1aCG5dByeOspcREk",libraries:["geometry","drawing"]}),[a]=l.Z.useForm(),s=(0,g.s0)(),{editId:b}=(0,p.v9)((e=>e.editData)),Z=(0,p.I0)(),[y,S]=(0,t.useState)({lat:null,lng:null}),{mutate:F,data:I,isLoading:w,isSuccess:E}=(0,d.useMutation)((e=>{let{url:a,data:s}=e;return m.Z.postData(a,s)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{r.ZP.error(e)}}),{isLoading:v,data:C,refetch:V,isSuccess:k}=(0,d.useQuery)(["edit-map",b],(()=>m.Z.getDataByID("/about/map",b)),{enabled:!1}),{mutate:z,isLoading:L,data:_,isSuccess:D}=(0,d.useMutation)((e=>{let{url:a,data:s,id:t}=e;return m.Z.editData(a,s,t)}),{onSuccess:()=>{r.ZP.success("Success")},onError:e=>{r.ZP.error(e.message)}});(0,t.useEffect)((()=>{D&&Z({type:h.Pb,payload:""}),(E||D)&&s("/map")}),[I,_]),(0,t.useEffect)((()=>{""!==b&&V()}),[b]),(0,t.useEffect)((()=>{""===b&&(a.setFieldsValue(j),S({lat:41.311785,lng:69.279696}))}),[]),(0,t.useEffect)((()=>{if(k){const e={name_ru:C.name_ru,name_uz:C.name_uz,phone:C.phone,lat:C.lat};S({lat:Number(C.lat),lng:Number(C.lng)}),a.setFieldsValue(e)}}),[C]);(0,t.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],a.setFieldsValue(e));const s=()=>{localStorage.setItem("myFormValues",JSON.stringify(a.getFieldsValue()))};return window.addEventListener("beforeunload",s),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",s)}}),[]);return(0,x.jsx)("div",{children:w||v||L?(0,x.jsx)(c.QP,{}):(0,x.jsxs)(l.Z,{form:a,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:j,onFinish:e=>{const a={...e,lat:y.lat,lng:y.lng};C?z({url:"/about/map",data:a,id:b}):F({url:"/about/map/",data:a})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,x.jsxs)(n.Z,{gutter:20,children:[(0,x.jsx)(i.Z,{span:12,children:(0,x.jsx)(l.Z.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u043b\u0438\u0430\u043b\u0430 Ru",name:"name_ru",rules:[{required:!0,message:"\u0412\u0432\u043e\u0434 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0444\u0438\u043b\u0438\u0430\u043b\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d Ru!"}],children:(0,x.jsx)(u.default,{})})}),(0,x.jsx)(i.Z,{span:12,children:(0,x.jsx)(l.Z.Item,{label:"Filial nomi Uz",name:"name_uz",rules:[{required:!0,message:"Filial nomini kiritish majburiy Uz!"}],children:(0,x.jsx)(u.default,{})})})]}),(0,x.jsx)(n.Z,{gutter:20,children:(0,x.jsx)(i.Z,{span:24,children:(0,x.jsx)(l.Z.Item,{label:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",name:"phone",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430!"}],children:(0,x.jsx)(u.default,{})})})}),(0,x.jsx)(n.Z,{gutter:20,children:(0,x.jsxs)(i.Z,{span:24,children:[e&&(0,x.jsx)(f.b6,{mapContainerStyle:{height:"400px",width:"100%"},zoom:12,center:y,onClick:e=>{const s={lat:e.latLng.lat(),lng:null===e||void 0===e?void 0:e.latLng.lng()};S(s),a.setFieldsValue({lat:s.lat})},children:(0,x.jsx)(f.jC,{position:y})}),(0,x.jsx)(l.Z.Item,{label:"",name:"lat",rules:[{required:!0,message:"\u0420\u0430\u0437\u043c\u0435\u0442\u043a\u0430 \u043a\u0430\u0440\u0442\u044b \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430"}]})]})}),(0,x.jsx)(o.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:k?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=325.e81511f6.chunk.js.map