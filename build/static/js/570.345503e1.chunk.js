"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[570],{46570:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Z});var r=t(72791),s=t(2409),l=t(50419),n=t(66106),u=t(30914),i=t(49389),o=t(93086),d=t(87309),c=t(91933),m=t(27169),p=t(14138),_=t(57689),f=t(16030),g=t(77221),x=t(66920),b=t(68117),j=t(80184);const h={full_name_uz:"",full_name_ru:"",job_uz:"",job_ru:"",text_uz:"",text_ru:"",image:"",facebook:"",instagram:"",telegram:"",youtube:""},Z=()=>{const[e]=s.Z.useForm(),a=(0,_.s0)(),{editId:t}=(0,f.v9)((e=>e.editData)),Z=(0,f.I0)(),[F,v]=(0,r.useState)([]),{mutate:w,data:z,isLoading:y,isSuccess:I}=(0,c.useMutation)((e=>{let{url:a,data:t}=e;return m.Z.postData(a,t)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let a in e.response.data)l.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}}),{isLoading:S,data:k,refetch:E,isSuccess:L}=(0,c.useQuery)(["edit-partner",t],(()=>m.Z.getDataByID("/about/partner",t)),{enabled:!1}),{mutate:V,isLoading:D,data:P,isSuccess:C}=(0,c.useMutation)((e=>{let{url:a,data:t,id:r}=e;return m.Z.editData(a,t,r)}),{onSuccess:()=>{l.ZP.success("Success")},onError:e=>{for(let a in e.response.data)l.ZP.error("".concat(a,": ").concat(e.response.data[a][0]))}});(0,r.useEffect)((()=>{C&&Z({type:g.Pb,payload:""}),(I||C)&&a("/partner")}),[z,P]),(0,r.useEffect)((()=>{""!==t&&E()}),[t]),(0,r.useEffect)((()=>{""===t&&e.setFieldsValue(h)}),[]),(0,r.useEffect)((()=>{if(L){const a=[{uid:null===k||void 0===k?void 0:k.id,name:null===k||void 0===k?void 0:k.id,status:"done",url:null===k||void 0===k?void 0:k.image}],t={full_name_uz:k.full_name_uz,full_name_ru:k.full_name_ru,job_uz:k.job_uz,job_ru:k.job_ru,text_uz:k.text_uz,text_ru:k.text_ru,image:k.image,facebook:"",instagram:"",telegram:"",youtube:""};v(a),e.setFieldsValue(t)}}),[k]);(0,r.useEffect)((()=>{const a=JSON.parse(localStorage.getItem("myFormValues"));a&&(a.images=[],e.setFieldsValue(a));const t=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",t),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);return(0,j.jsx)("div",{children:y||S||D?(0,j.jsx)(p.QP,{}):(0,j.jsxs)(s.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:h,onFinish:e=>{var a;const r=new FormData;var s;(r.append("full_name_uz",e.full_name_uz),r.append("full_name_ru",e.full_name_ru),r.append("job_uz",""),r.append("job_ru",""),r.append("text_uz",e.text_uz),r.append("text_ru",e.text_ru),null!==(a=F[0])&&void 0!==a&&a.originFileObj)&&r.append("image",null===(s=F[0])||void 0===s?void 0:s.originFileObj);r.append("facebook",""),r.append("telegram",""),r.append("instagram",""),r.append("youtube",""),k?V({url:"/about/partner",data:r,id:t}):w({url:"/about/partner/",data:r})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,j.jsxs)(n.Z,{gutter:20,children:[(0,j.jsx)(u.Z,{span:12,children:(0,j.jsx)(s.Z.Item,{label:"Full Name Uz",name:"full_name_uz",rules:[{required:!0,message:"F.I.O ni kiritish talab qilinadi"}],children:(0,j.jsx)(i.default,{})})}),(0,j.jsx)(u.Z,{span:12,children:(0,j.jsx)(s.Z.Item,{label:"\u041f\u043e\u043b\u043d\u043e\u0435 \u0438\u043c\u044f Ru",name:"full_name_ru",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u041f\u043e\u043b\u043d\u043e\u0435 \u0438\u043c\u044f"}],children:(0,j.jsx)(i.default,{})})})]}),(0,j.jsxs)(n.Z,{gutter:20,children:[(0,j.jsx)(u.Z,{span:12,children:(0,j.jsx)(s.Z.Item,{label:"Fikr-mulohaza",name:"text_uz",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f Fikr-mulohaza"}],children:(0,j.jsx)(x.Z,{rows:4})})}),(0,j.jsx)(u.Z,{span:12,children:(0,j.jsx)(s.Z.Item,{label:"\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u0432\u044f\u0437\u044c",name:"text_ru",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u0432\u044f\u0437\u044c"}],children:(0,j.jsx)(x.Z,{rows:4})})})]}),(0,j.jsx)(n.Z,{gutter:20,children:(0,j.jsx)(s.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",name:"image",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c"}],children:(0,j.jsx)(b.Z,{rotationSlider:!0,children:(0,j.jsx)(o.Z,{maxCount:1,fileList:F,listType:"picture-card",onChange:a=>{let{fileList:t}=a;v(t),e.setFieldsValue({image:t})},onPreview:async e=>{let a=e.url;a||(a=await new Promise((a=>{const t=new FileReader;t.readAsDataURL(e.originFileObj),t.onload=()=>a(t.result)})));const t=new Image;t.src=a;const r=window.open(a);null===r||void 0===r||r.document.write(t.outerHTML)},beforeUpload:()=>!1,children:F.length>0?"":"Upload"})})})}),(0,j.jsx)(d.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:L?"Edit":"Add"})]})})}},30914:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t(89752).Z}}]);
//# sourceMappingURL=570.345503e1.chunk.js.map