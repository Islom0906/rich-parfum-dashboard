"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[325],{68438:function(e,t,n){n.d(t,{Z:function(){return o}});var a=n(74165),r=n(15861),u=n(74569),s=n.n(u);s().defaults.baseURL="".concat("http://95.46.96.105/backend/api"),s().interceptors.request.use((function(e){var t=function(e){try{return localStorage.getItem(e)}catch(t){console.log("Error getting data")}}("richtoken"),n=null!==t?"Bearer ".concat(t):"";return e.headers.authorization=n,e}));var i=s(),o={getData:function(e){return(0,r.Z)((0,a.Z)().mark((function t(){var n,r;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.get(e);case 2:return n=t.sent,r=n.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})))()},getDataByID:function(e,t){return(0,r.Z)((0,a.Z)().mark((function n(){var r,u;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.get("".concat(e,"/").concat(t));case 2:return r=n.sent,u=r.data,n.abrupt("return",u);case 5:case"end":return n.stop()}}),n)})))()},postData:function(e,t){return(0,r.Z)((0,a.Z)().mark((function n(){var r,u;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.post(e,t);case 2:return r=n.sent,u=r.data,n.abrupt("return",u);case 5:case"end":return n.stop()}}),n)})))()},editData:function(e,t,n){return(0,r.Z)((0,a.Z)().mark((function r(){var u,s;return(0,a.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.put("".concat(e,"/").concat(n,"/"),t);case 2:return u=a.sent,s=u.data,a.abrupt("return",s);case 5:case"end":return a.stop()}}),r)})))()},deleteData:function(e,t){return(0,r.Z)((0,a.Z)().mark((function n(){return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.delete("".concat(e,"/").concat(t));case 2:case"end":return n.stop()}}),n)})))()},deleteImages:function(e,t){return(0,r.Z)((0,a.Z)().mark((function n(){return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(),n.next=3,i.delete(e,{data:t});case 3:case"end":return n.stop()}}),n)})))()}}},325:function(e,t,n){n.r(t);var a=n(1413),r=n(29439),u=n(72791),s=n(2409),i=n(50419),o=n(66106),c=n(30914),l=n(49389),d=n(87309),m=n(91933),f=n(68438),p=n(14138),g=n(57689),Z=n(16030),h=n(77221),x=n(7993),v=n(80184),b={name_ru:"",name_uz:"",workingTime:"",tel:"",lat:""};t.default=function(){var e=(0,x.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyDt2upRTGqJ3BOGeKN1aCG5dByeOspcREk",libraries:["geometry","drawing"]}).isLoaded,t=s.Z.useForm(),n=(0,r.Z)(t,1)[0],w=(0,g.s0)(),j=(0,Z.v9)((function(e){return e.editData})).editId,y=(0,Z.I0)(),S=(0,u.useState)({lat:null,lng:null}),k=(0,r.Z)(S,2),I=k[0],F=k[1],D=(0,u.useState)({lat:41.311785,lng:69.279696}),E=(0,r.Z)(D,2),z=E[0],C=E[1],L=(0,m.useMutation)((function(e){var t=e.url,n=e.data;return f.Z.postData(t,n)}),{onSuccess:function(){i.ZP.success("Success")},onError:function(e){i.ZP.error(e)}}),V=L.mutate,_=L.data,q=L.isLoading,P=L.isSuccess,B=(0,m.useQuery)(["edit-map",j],(function(){return f.Z.getDataByID("/about/map",j)}),{enabled:!1}),N=B.isLoading,R=B.data,J=B.refetch,O=B.isSuccess,T=(0,m.useMutation)((function(e){var t=e.url,n=e.data,a=e.id;return f.Z.editData(t,n,a)}),{onSuccess:function(){i.ZP.success("Success")},onError:function(e){i.ZP.error(e.message)}}),A=T.mutate,G=T.isLoading,M=T.data,U=T.isSuccess;(0,u.useEffect)((function(){U&&y({type:h.Pb,payload:""}),(P||U)&&w("/map")}),[_,M]),(0,u.useEffect)((function(){""!==j&&J()}),[j]),(0,u.useEffect)((function(){""===j&&n.setFieldsValue(b)}),[]),(0,u.useEffect)((function(){if(O){var e={name_ru:R.name_ru,name_uz:R.name_uz,phone:R.phone,lat:R.lat};F({lat:Number(R.lat),lng:Number(R.lng)}),n.setFieldsValue(e)}}),[R]);(0,u.useEffect)((function(){var e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],n.setFieldsValue(e));var t=function(){localStorage.setItem("myFormValues",JSON.stringify(n.getFieldsValue()))};return window.addEventListener("beforeunload",t),function(){localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);return(0,v.jsx)("div",{children:q||N||G?(0,v.jsx)(p.QP,{}):(0,v.jsxs)(s.Z,{form:n,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:b,onFinish:function(e){var t=(0,a.Z)((0,a.Z)({},e),{},{lat:I.lat,lng:I.lng});R?A({url:"/about/map",data:t,id:j}):V({url:"/about/map/",data:t})},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,v.jsxs)(o.Z,{gutter:20,children:[(0,v.jsx)(c.Z,{span:12,children:(0,v.jsx)(s.Z.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u043b\u0438\u0430\u043b\u0430 Ru",name:"name_ru",rules:[{required:!0,message:"\u0412\u0432\u043e\u0434 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0444\u0438\u043b\u0438\u0430\u043b\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d Ru!"}],children:(0,v.jsx)(l.Z,{})})}),(0,v.jsx)(c.Z,{span:12,children:(0,v.jsx)(s.Z.Item,{label:"Filial nomi Uz",name:"name_uz",rules:[{required:!0,message:"Filial nomini kiritish majburiy Uz!"}],children:(0,v.jsx)(l.Z,{})})})]}),(0,v.jsx)(o.Z,{gutter:20,children:(0,v.jsx)(c.Z,{span:24,children:(0,v.jsx)(s.Z.Item,{label:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",name:"phone",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430!"}],children:(0,v.jsx)(l.Z,{})})})}),(0,v.jsx)(o.Z,{gutter:20,children:(0,v.jsxs)(c.Z,{span:24,children:[e&&(0,v.jsx)(x.b6,{mapContainerStyle:{height:"400px",width:"100%"},zoom:12,center:z,onClick:function(e){var t={lat:e.latLng.lat(),lng:null===e||void 0===e?void 0:e.latLng.lng()};C(t),F(t),n.setFieldsValue({lat:t.lat})},children:(0,v.jsx)(x.jC,{position:I})}),(0,v.jsx)(s.Z.Item,{label:"",name:"lat",rules:[{required:!0,message:"\u0420\u0430\u0437\u043c\u0435\u0442\u043a\u0430 \u043a\u0430\u0440\u0442\u044b \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430"}]})]})}),(0,v.jsx)(d.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:O?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=325.598b1dea.chunk.js.map