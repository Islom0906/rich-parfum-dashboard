"use strict";(self.webpackChunkcrema=self.webpackChunkcrema||[]).push([[890],{68438:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(74165),a=n(15861),c=n(74569),s=n.n(c);s().defaults.baseURL="".concat("http://95.46.96.105/backend/api"),s().interceptors.request.use((function(e){var t=function(e){try{return localStorage.getItem(e)}catch(t){console.log("Error getting data")}}("richtoken"),n=null!==t?"Bearer ".concat(t):"";return e.headers.authorization=n,e}));var u=s(),o={getData:function(e){return(0,a.Z)((0,r.Z)().mark((function t(){var n,a;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.get(e);case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))()},getDataByID:function(e,t){return(0,a.Z)((0,r.Z)().mark((function n(){var a,c;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.get("".concat(e,"/").concat(t));case 2:return a=n.sent,c=a.data,n.abrupt("return",c);case 5:case"end":return n.stop()}}),n)})))()},postData:function(e,t){return(0,a.Z)((0,r.Z)().mark((function n(){var a,c;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.post(e,t);case 2:return a=n.sent,c=a.data,n.abrupt("return",c);case 5:case"end":return n.stop()}}),n)})))()},editData:function(e,t,n){return(0,a.Z)((0,r.Z)().mark((function a(){var c,s;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.put("".concat(e,"/").concat(n,"/"),t);case 2:return c=r.sent,s=c.data,r.abrupt("return",s);case 5:case"end":return r.stop()}}),a)})))()},deleteData:function(e,t){return(0,a.Z)((0,r.Z)().mark((function n(){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.delete("".concat(e,"/").concat(t));case 2:case"end":return n.stop()}}),n)})))()},deleteImages:function(e,t){return(0,a.Z)((0,r.Z)().mark((function n(){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(),n.next=3,u.delete(e,{data:t});case 3:case"end":return n.stop()}}),n)})))()}}},39890:function(e,t,n){n.r(t);var r=n(29439),a=n(72791),c=n(2409),s=n(50419),u=n(66106),o=n(30914),i=n(49389),d=n(87309),f=n(91933),l=n(68438),p=n(14138),m=n(57689),Z=n(16030),g=n(77221),v=n(80184),x={name:"",date:""};t.default=function(){var e=c.Z.useForm(),t=(0,r.Z)(e,1)[0],n=(0,m.s0)(),h=(0,Z.v9)((function(e){return e.editData})).editId,w=(0,Z.I0)(),y=(0,f.useMutation)((function(e){var t=e.url,n=e.data;return l.Z.postData(t,n)}),{onSuccess:function(){s.ZP.success("Success")},onError:function(e){for(var t in e.response.data)s.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),b=y.mutate,S=y.data,I=y.isLoading,k=y.isSuccess,D=(0,f.useQuery)(["edit-index-category",h],(function(){return l.Z.getDataByID("/products/index-category",h)}),{enabled:!1}),F=D.isLoading,j=D.data,E=D.refetch,V=D.isSuccess,L=(0,f.useMutation)((function(e){var t=e.url,n=e.data,r=e.id;return l.Z.editData(t,n,r)}),{onSuccess:function(){s.ZP.success("Success")},onError:function(e){for(var t in e.response.data)s.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),P=L.mutate,C=L.isLoading,B=L.data,N=L.isSuccess;(0,a.useEffect)((function(){N&&w({type:g.Pb,payload:""}),(k||N)&&n("/index-category")}),[S,B]),(0,a.useEffect)((function(){""!==h&&E()}),[h]),(0,a.useEffect)((function(){""===h&&t.setFieldsValue(x)}),[]),(0,a.useEffect)((function(){if(V){var e={name:j.name,date:null===j.date?"":j.date};t.setFieldsValue(e)}}),[j]);return(0,a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],t.setFieldsValue(e));var n=function(){localStorage.setItem("myFormValues",JSON.stringify(t.getFieldsValue()))};return window.addEventListener("beforeunload",n),function(){localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",n)}}),[]),(0,v.jsx)("div",{children:I||F||C?(0,v.jsx)(p.QP,{}):(0,v.jsxs)(c.Z,{form:t,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:x,onFinish:function(e){j?P({url:"/products/index-category",data:e,id:h}):b({url:"/products/index-category/",data:e})},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,v.jsxs)(u.Z,{gutter:20,children:[(0,v.jsx)(o.Z,{span:12,children:(0,v.jsx)(c.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430"}],children:(0,v.jsx)(i.Z,{})})}),(0,v.jsx)(o.Z,{span:12,children:(0,v.jsx)(c.Z.Item,{label:"\u0414\u0430\u0442\u0430 (\u041d\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e)",name:"date",children:(0,v.jsx)(i.Z,{})})})]}),(0,v.jsx)(d.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:V?"Edit":"Add"})]})})}},30914:function(e,t,n){var r=n(89752);t.Z=r.Z}}]);
//# sourceMappingURL=890.2fbade0d.chunk.js.map